{
  "calculator": "Here is the generated Mermaid flowchart for the `addOrUpdateEncouragement` method:\n```graph LR\r\nA[calculate encouragement !\u003d null]\r\n-\u003e|true| B\r\n-\u003e|false| E\r\n\r\nB[calculate personnelReviewCreator !\u003d null]\r\n-\u003e|true| C\r\n-\u003e|false| F\r\n\r\nC[calculate checkingRegistrarPowerLimits]\r\n-\u003e|true| D\r\n-\u003e|false| G\r\n\r\nD[calculate currentUserRole equals ROLE.ENCOURAGEMENT_SPECIALIST.getValue()]\r\n-\u003e|true| H\r\n-\u003e|false| I\r\n\r\nH[calculate encouragedPersonRank \u003e\u003d RankTypeEnum.SECOND_LIEUTENANT.getRankCode()]\r\n-\u003e|true| J\r\n-\u003e|false| K\r\n\r\nJ[sendForVedjaCommission(encouragement, personnelReviewCreator)]\r\nK[changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode())]\r\n\r\nI[calculate isGreaterThanSecondLieutenant]\r\n-\u003e|true| L\r\n-\u003e|false| M\r\n\r\nL[sendForVedjaCommission(encouragement, personnelReviewCreator)]\r\nM[changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode())]\r\n\r\nG[calculate amountOfEncouragementIsWithinThePowerLimits]\r\n-\u003e|true| N\r\n-\u003e|false| O\r\n\r\nN[changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode())]\r\n-\u003e afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole)\r\n\r\nO[calculate encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())]\r\n-\u003e|true| P\r\n-\u003e|false| Q\r\n\r\nP[changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode())]\r\n-\u003e afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole)\r\n\r\nQ[throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\")]\r\nE[throw new GeneralException(\"شخص تشویق کننده یافت نشد .\")]\r\n\r\nF[throw new GeneralException(\"شخص تشویق شونده یافت نشد .\")]\r\n\r\nE[throw new GeneralException(\"پارامتر ورودی صحیح نمی باشد .\")]\r\n```\nNote that I\u0027ve included all `if`/`else` conditions, loops (none in this case), and method calls (`calculator`, `sendForVedjaCommission`, `changeEncouragementStatus`, `afterCheckingRegistrarPowerLimit`) with their business roles. I\u0027ve also annotated each action with a brief note on variable calculations using parentheses, as per your request.",
  "afterCheckingRegistrarPowerLimit": "Here is the generated Mermaid flowchart:\n\n```mermaid\ngraph LR\n    A[check if update mode -\u003e !isUpdateMode] --\u003e|false| B(create review from encouragement)\n    B --\u003e C[calculate personnel organization ID -\u003e personnelOrganizationID \u003d personnelReviewCreator.getPersonnelOrganizationID()]\n    B --\u003e D[set review result code -\u003e ReviewResultEnum.APPROVED.getCode()]\n    B --\u003e E[set review type code -\u003e ReviewTypeEnum.ORDINARY_REVIEWER.getCode()]\n    B --\u003e F[set draft code -\u003e DraftEnum.Sent.getCode()]\n    B --\u003e G(null)\n    H[check if encouraged person has manager] --\u003e|true| I(forward encouragement for next step)\n    I --\u003e J[calculate personnel organization ID -\u003e personnelOrganizationID \u003d personnelReviewCreator.getPersonnelOrganizationID()]\n    I --\u003e K[calculate encouraged person id -\u003e encouragedId \u003d encouragedPerson.getEncouragementId()]\n    I --\u003e L[calculate review type code -\u003e ReviewTypeEnum.ORDINARY_REVIEWER.getCode()]\n    I --\u003e M(forward encouragement for next step, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole)\n    I --\u003e N[throw general exception]\n    O[check if encouraged person has manager] --\u003e|false| P(throw general exception)\n    P --\u003e Q[\"لیست مدیران شخص وارد شده خالی می باشد.\"]\n```\n\nHere\u0027s a brief explanation of each step:\n\nA. Check if update mode is false.\n\nB. If not, create a review from encouragement with personnel organization ID, review result code, review type code, draft code, and null.\n\nC-E. Calculate personnel organization ID, review result code, review type code, and draft code using method calls.\n\nF. Set draft code to `DraftEnum.Sent.getCode()`.\n\nG. No further actions for this branch.\n\nH. Check if encouraged person has a manager (returns true or false).\n\nI-J. If true, forward encouragement for next step with personnel organization ID, encouraged person id, review type code, and other parameters.\n\nK. Calculate encouraged person id using `encouragedPerson.getEncouragementId()`.\n\nL. Set review type code to `ReviewTypeEnum.ORDINARY_REVIEWER.getCode()`.\n\nM. Forward encouragement for the next step with all calculated values.\n\nN. If there\u0027s an error, throw a general exception.\n\nO. Check if encouraged person has a manager (returns true or false).\n\nP-Q. If false, throw a general exception with the message \"لیست مدیران شخص وارد شده خالی می باشد.\".\n\nPlease note that this flowchart represents the business logic of the given Java method `addOrUpdateEncouragement`.",
  "forwardPreviousManager": "Here is the generated Mermaid flowchart for the `addOrUpdateEncouragement` method:\n\n```mermaid\ngraph LR\nA[Check creatorIndex - 1 \u003e\u003d 0] -\u003e\u003e B[Get next and previous manager organization IDs]\nB -- check condition: (creatorIndex + 1 \u003c\u003d personnelManager.getPersonnelManagerOrganizationIdList().size() - 1)\nC[Get previous encouragement review]\nD[Calculate previous manager organization ID: personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 1)]\nE[Get next encouragement review, if exists]\nF[Delete recent manager review, if necessary]\nG[Check encouragement status and isEncouragementSeen]\nH[Create review from encouragement, if necessary]\nI[Sent for registrar, if previous manager organization ID equals encouragement\u0027s registrar organization ID]\nJ[Update exist encouragement review, if necessary]\nK[Delete approved next encouragement review, if exists]\nL[Throw GeneralException: \"مدیر قبلی ایی وجود ندارد\", if creatorIndex - 1 \u003c 0]\n\nB --\u003e C\nC --\u003e D\nD --* E\nE -\u003e F\nF -\u003e G\nG --\u003e H[check condition: previousEncouragementReview.isPresent() \u0026\u0026 encouragement.getIsEncouragementSeen()]\nH --* I\nI -\u003e J\nJ --* K\nK -\u003e L\n\n```\n\nNote:\n\n- `A` to `L` are node labels representing the method\u0027s actions.\n- The arrows (`-\u003e`) represent control flow (conditional statements, loops, and method calls).\n- The conditions in parentheses next to each node label indicate any calculations or checks performed within that step.\n- For variable assignments or computations, I\u0027ve included brief notes in parentheses.",
  "forwardNextManager": "Here is the generated Mermaid flowchart:\n```\ngraph LR\nA[delete recent manager review? -\u003e deleteRecentManagerReview]\n-\u003e\u003e B[if true, call method -\u003e deleteRegistrarReviewIfExist(encouragement)]\nB-\u003e\u003e C[continue with next steps]\n\nC[check if there are more managers? -\u003e creatorIndex + 1 \u003c managerPositionList.size()]\n-\u003e\u003e D[if true, get next manager organization ID -\u003e String nextManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex + 1)]\nD-\u003e\u003e E[get encouragement review for next manager -\u003e Optional\u003cEncouragementReview\u003e nextEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(nextManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode())]\n\nE-\u003e\u003e F[check if previous manager exists? -\u003e creatorIndex - 1 \u003e\u003d 0]\nF-\u003e\u003e G[if true, get previous manager organization ID -\u003e String previousManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 1)]\nG-\u003e\u003e H[get encouragement review for previous manager -\u003e Optional\u003cEncouragementReview\u003e previousEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(previousManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode())]\nH-\u003e\u003e I[delete previous encouragement review -\u003e previousEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()))]\n\nI-\u003e\u003e J[next encouragement review present? -\u003e nextEncouragementReview.isPresent()]\nJ-\u003e\u003e K[if rejection or approval, delete next encouragement review -\u003e if (encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode()))]\nK-\u003e\u003e L[update next encouragement review -\u003e nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement))]\nL-\u003e\u003e M[update current encouragement review -\u003e thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement))]\n\nM-\u003e\u003e N[if no next manager, check encouragement status? -\u003e encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())]\nN-\u003e\u003e O[delete commission review if rejection or approval -\u003e Optional\u003cEncouragementReview\u003e commissionEncouragementReview \u003d encouragementReviewService.getAllCommissionReviewsForThisEncouragement(encouragement.getEncouragementId()); commissionEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));]\nO-\u003e\u003e P[no deletion, create new review -\u003e this.createReviewFromEncouragement(encouragement, nextManagerOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex));]\n\nP-\u003e\u003e Q[else, check if there are more managers? -\u003e creatorIndex + 1 \u003c managerPositionList.size()]\nQ-\u003e\u003e R[no, create review from encouragement]\nR-\u003e\u003e S[create commission input? -\u003e commissionInput(encouragement, personnelManager.getPersonnelManagerOrganizationIdList().size() - 1 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) : null, personnelReviewCreator);]\nS-\u003e\u003e T[update encouragement review -\u003e Optional\u003cEncouragementReview\u003e optional \u003d encouragementReviewService.getAllCommissionReviewsForThisEncouragement(encouragement.getEncouragementId()); if (optional.isPresent()) {...} else {...}]\nT-\u003e\u003e U[end of method]\n```\nNote: This flowchart represents the exact logic of the `addOrUpdateEncouragement` method, including all variable calculations and conditional statements.",
  "addOrUpdateEncouragement": "Here is the generated Mermaid flowchart for the `addOrUpdateEncouragement` method:\n\n```mermaid\ngraph LR\nA[get current user role -\u003e currentUserRole \u003d authService.getCurrentUserProfile().getCurrentRole()]\nB[check if request and encouragementRelatedPersonnelOrganizationIds are not null]\nC[create empty list for encouragements]\nD[initialize reasonType variable to null]\nE[validate request amount and reasonType]\nF[iterate through encouragementRelatedPersonnelOrganizationIds]\nG[find PersonnelDTO by organizationId -\u003e encouragedPerson \u003d personnelService.findByOrganizationId(personnelOrganizationId, typeOfPersonnelDTOWithManagerSending)]\nH[check if encouragedPerson is not permanent member]\nI[check if registrar\u0027s unit code matches with the personnel\u0027s unit code]\nJ[check if registrar exists in personnel manager]\nK[create or update encouragement and add to list -\u003e encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId)]\nL[add encouragement to encouragements list]\nM[save all encouragements -\u003e resultList \u003d encouragementRepository.saveAll(encouragements)]\r\nN[check if result list is not empty and draft type is sent]\nO[iterate through encouragements in result list]\nP[calculate and update encouragement status using calculator method -\u003e this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole)]\r\nQ[update encouragement review status if necessary]\nR[update sent for registrar encouragement review has been seen]\nS[return result list -\u003e return resultList]\nT[throw GeneralException if input parameters are invalid]\n\nB --\u003e|request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null|\u003e A\nA --\u003e|get current user role -\u003e currentUserRole \u003d authService.getCurrentUserProfile().getCurrentRole()|\nE --\u003e|validate request amount and reasonType|\nF --\u003e|iterate through encouragementRelatedPersonnelOrganizationIds|\nG --\u003e|find PersonnelDTO by organizationId -\u003e encouragedPerson \u003d personnelService.findByOrganizationId(personnelOrganizationId, typeOfPersonnelDTOWithManagerSending)|\nH --\u003e|check if encouragedPerson is not permanent member|\nI --\u003e|check if registrar\u0027s unit code matches with the personnel\u0027s unit code|\nJ --\u003e|check if registrar exists in personnel manager|\nK --\u003e|create or update encouragement and add to list -\u003e encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId)|\nL --\u003e|add encouragement to encouragements list|\nM --\u003e|save all encouragements -\u003e resultList \u003d encouragementRepository.saveAll(encouragements)|\r\nN --\u003e|check if result list is not empty and draft type is sent|\nO --\u003e|iterate through encouragements in result list|\nP --\u003e|calculate and update encouragement status using calculator method -\u003e this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole)|\nQ --\u003e|update encouragement review status if necessary|\nR --\u003e|update sent for registrar encouragement review has been seen|\nS --\u003e|return result list -\u003e return resultList|\nT --\u003e|throw GeneralException if input parameters are invalid|\n\n```\n\nPlease note that the generated flowchart is automatically generated and might not be 100% accurate.",
  "commissionInput": "Here is the generated Mermaid flowchart:\n```graph LR\r\nA[commissionInput method starts]\r\n-\u003e|encouragement parameter|\u003e B[Get commission encouragement reviews for given encouragement ID]\r\nB-\u003e\u003e C[Check if reviews are empty? (isEmpty())]\r\nC--\u003e(yes) D[Create review from encouragement]\r\nD[createReviewFromEncouragement method called with params: encouragement, null, ReviewResultEnum.UNDER_COMMISSION_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_COMMISSION.getCode(), DraftEnum.Nothing.getCode(), personnelManager]\r\n-\u003e|else|\u003e E[Update existent encouragement]\r\nE-\u003e\u003e F[Get existing commission encouragement review from service]\r\nF-\u003e\u003e G[Check if encouragement status is not NEED_FOR_ACCEPT (equals)?]\r\nG--\u003e(no) H[Change encouragement status to UNDER_COMMISSION_REVIEW with params: encouragement, EncouragementResultEnum.UNDER_COMMISSION_REVIEW.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_COMMISSION.getCode()]\r\nH-\u003e|encouragement status updated|\u003e A[commissionInput method ends]\n```\nNote that I\u0027ve used the exact variable and method names from the code, and included annotations for each action with brief notes on variable calculations using parentheses.\n\nLet me know if this meets your requirements!",
  "updateEncouragementReview": "Here is the generated Mermaid flowchart:\n\n```mermaid\ngraph LR\nA[Read encouragementReviewUpdateDTO -\u003e EncouragementReviewUpdateDTO object] \nB[Get current user profile -\u003e PersonnelDTO]\nC[Find encouragement review by id -\u003e EncouragementReview entity]\nD[Check if entity exists (throw exception)]\nE[Check if draft is sent and seen, throw exception if true]\nF[Create concatenated description for encouragement, call calculator]\nG[Check if entity has id, add file attachments]\nH[Get all commission reviews for this encouragement (optional)]\r\nI[Check if encouragement review type is ordinary or Vedja, set optional accordingly]\nJ[Check if encouragement amount, type, and reason type have changed (throw exception if true)]\nK[Update encouragement if draft is sent and result is correction and approval]\nL[Update each encouragement review that needed, call calculator]\nM[Throw RuntimeException if any exception occurs]\n\nA --\u003e D\nD --\u003e E\nE --\u003e F\nF --\u003e G\nG --\u003e H\nH --\u003e I\nI --\u003e J\nJ --\u003e K\nK --\u003e L\nL --\u003e M\n```\n\nNote: The Mermaid syntax used here is a simplified version of the actual code, focusing on the main logic and variable calculations.",
  "sentForRegistrar": "Here is the generated Mermaid flowchart:\n\n```mermaid\ngraph LR\nA[get registrarOrganizationId -\u003e registrarOrganizationId \u003d encouragement.getEncouragementRegistrarOrganizationId()] --\u003e B[get index of registrarOrgId in personnelManager\u0027s list -\u003e registrarOrgIdIndex \u003d personnelManager.getPersonnelManagerOrganizationIdList().indexOf(registrarOrganizationId)]\nC[check if previousManagerOrganizationId is not equal to registrarOrganizationId] --\u003e D[get review of this registrar with under-review status and reviewer type for previous manager]\nD --\u003e E[delete encouragement review if present -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId())]\nF[change encouragement status to SENT FOR CORRECTION] --\u003e G[get review of this registrar with under-review status and reviewer type for registrar]\nG --\u003e H[check if review is empty]\nH --\u003e|not empty| I[update existing encouragement review -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement)]\nH --\u003e|empty| J[create new review from encouragement -\u003e createReviewFromEncouragement(encouragement, registrarOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REWER.getCode(), DraftEnum.Nothing.getCode(), registrarOrgIdIndex - 1 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(registrarOrgIdIndex - 1) : null)]\n```\n\nPlease note that I\u0027ve annotated each action with a brief note on variable calculations using parentheses, as per your request.",
  "deleteRegistrarReviewIfExist": "Here is the generated Mermaid flowchart for the `addOrUpdateEncouragement` method:\n\n```mermaid\ngraph LR\nA[Get registrar encouragement review]\nA-\u003e\u003eB{Optional\u003cEncouragementReview\u003e}\nB--1-\u003eC[Get Review of This Registrar This Encouragement with Under Review Status and Reviewer Type]\nC-\u003e\u003eD{encouragementReviewService}\nD-.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType( encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode() )\nE[Present and Delete Encouragement Review]\nE-\u003e\u003eF{encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId())}\n```\n\nHere\u0027s a brief explanation of each step:\n\n1. `Get registrar encouragement review`: The method starts by calling the `getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType` method to retrieve an optional `EncouragementReview` object.\n2. `Optional\u003cEncouragementReview\u003e`: This step represents the presence of the `encouragementReview` object, which is either present or not (i.e., empty).\n3. `Get Review of This Registrar This Encouragement with Under Review Status and Reviewer Type`: This step calls the `getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType` method to retrieve an optional `EncouragementReview` object based on the provided `encouragement` object.\n4. `Present and Delete Encouragement Review`: If the `encouragementReview` is present, it is deleted by calling the `deleteEncouragementReview` method.\n\nNote that there are no if-else conditions or loops in this method, so the flowchart does not include any branching or iteration logic. The method simply calls other methods and processes their results.",
  "updateEachEncouragementReviewThatNeeded": "Here is the generated Mermaid flowchart for the `addOrUpdateEncouragement` method:\n\n```mermaid\ngraph LR\r\nA[check if encouragement review seen] \r\nA-\u003e\u003eB{isEncouragementReviewSeen} \r\nB-\u003etrue[throw GeneralException] \r\nC[A] -\u003e D(check current user role)\r\nD-\u003e\u003eE{getCurrentRole}\r\nE-\u003e\u003eF(currentUserRole)\r\nF-\u003e*calculate total -\u003e currentUserRole \u003d getCurrentRole()*\n\nB-\u003efalse[C: proceed to update encouragement review]\r\nC-\u003e\u003eE1[update encouragement review entity with applied date]\r\nE1-\u003e*calculate total -\u003e encouragementReviewEncouragementAppliedDate \u003d encouragement.getEncouragementAppliedDate()*\n\nC-\u003e\u003eF1(update draft sent date if necessary)\r\nF1-\u003e*calculate total -\u003e encouragementReviewSentDraftDate \u003d LocalDate.now()*\n\nC-\u003e\u003eG1(update non-null fields in entity]\r\nG1-\u003e*no calculation required\r\n\r\nC-\u003e\u003eH(add encouragement review to service]\r\nH-\u003e*call add method on encouragementReviewService\r\n\r\nC-\u003e\u003eI(check result and draft)\r\nI-\u003e*calculate total -\u003e encouragementReviewResult !\u003d null\r\nI-\u003e*calculate total -\u003e encouragementReviewDraft.equals(DraftEnum.Sent.getCode())\r\n\r\nJ[A] -\u003e K(check if approved or rejection reason]\r\nK-\u003e*calculate total -\u003e encouragementReviewResult.equals(ReviewResultEnum.APPROVED.getCode()) || encouragementReviewResult.equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) || encouragementReviewResult.equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode()) || encouragementReviewResult.equals(ReviewResultEnum.REJECT_TO_COMMISSION.getCode())\r\n\r\nL[A] -\u003e M(check if ordinary reviewer or not]\r\nM-\u003e*calculate total -\u003e entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_REVIEWER.getCode())\r\n\r\nN[A] -\u003e O[calculate and update encouragement review with calculator method]\r\nO-\u003e*calculate total -\u003e this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, entity.getPersonnelOrganizationID(), currentUserRole)\r\n\r\nP[A] -\u003e Q[update encouragement review and send for Vedja commission if necessary]\r\nQ-\u003e*calculate total -\u003e dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode())\r\n\r\nR[A] -\u003e S[calculate and update encouragement review with calculator method for rejection reason]\r\nS-\u003e*calculate total -\u003e this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, null, currentUserRole)\r\n\r\nT[A] -\u003e U[change encouragement status if necessary]\r\nU-\u003e*no calculation required\r\n\r\nV[A] -\u003e W[send for Vedja commission if necessary]\r\nW-\u003e*calculate total -\u003e sendForVedjaCommission(encouragement, currentUser)\r\n\r\nX[A] -\u003e Y[update exist encouragement review and set seen to true if necessary]\r\nY-\u003e*calculate total -\u003e encouragementReviewService.updateExistEncouragementReview(entity, encouragement)\r\n\r\nZ[A] -\u003e AA[check for rejected reason and update status if necessary]\r\nAA-\u003e*calculate total -\u003e dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECTED.getCode())\r\n\r\nBB[A] -\u003e CC[change encouragement status and calculate with calculator method for rejection reason]\r\nCC-\u003e*calculate total -\u003e this.changeEncouragementStatus(encouragement, EncouragementResultEnum.REJECTED.getCode(), entity.getEncouragementReviewRegistrarOrganizationId(), entity.getEncouragementReviewType())\r\nCC-\u003e*calculate total -\u003e this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, entity.getEncouragementReviewRegistrarOrganizationId(), currentUserRole)\r\n\r\nDD[A] -\u003e EE[check for Sent For Registrar Correction reason and update encouragement review if necessary]\r\nEE-\u003e*calculate total -\u003e dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())\r\n\r\nFF[A] -\u003e GG[delete registrar review if exist and calculate with calculator method]\r\nGG-\u003e*calculate total -\u003e deleteRegistrarReviewIfExist(encouragement)\r\nGG-\u003e*calculate total -\u003e this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, entity.getEncouragementReviewPreviousOrganizationId(), currentUserRole)\r\n```\n\nThis flowchart accurately represents the business logic of the `addOrUpdateEncouragement` method, including all `if`/`else` conditions, loops, and internal method calls."
}