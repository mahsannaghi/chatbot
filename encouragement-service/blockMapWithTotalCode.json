{
  "updateEncouragementReview / if (// تاریخ تصویب وارد شده توسط کاربر همان تاریخ تصویب حقیقی تشویق؟\r\ndto.getEncouragementReviewAppliedDate() !\u003d null) / line1": "encouragement.setEncouragementAppliedDate(dto.getEncouragementReviewAppliedDate());",
  "addOrUpdateEncouragement / if ((registrar.getPersonnelUnitCode() \u003d\u003d null || encouragedPerson.getPersonnelUnitCode() \u003d\u003d null) || Objects.equals(registrar.getPersonnelUnitCode(), encouragedPerson.getPersonnelUnitCode())) / line1": "/**\r\n * @CheckExistsRegistrarInPersonnelManager\r\n */\r\nif (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) {\r\n    Encouragement encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId);\r\n    encouragement.setEncouragementTypeCategory(TypeCategoryEnum.NORMAL);\r\n    if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n        if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n            encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\n        else {\r\n            if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n                encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n            if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n                encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n        }\r\n    }\r\n    encouragements.add(encouragement);\r\n} else\r\n    throw new GeneralException(String.format(\"شما در سلسله مراتب پرسنل %s قرار ندارید.\", encouragedPerson.getPersonnelOrganizationID()));",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line2": "this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);",
  "sentForRegistrar / if (!previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId())) / line1": "Optional\u003cEncouragementReview\u003e previousEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(previousManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "sentForRegistrar / if (!previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId())) / line2": "//        nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));\r\npreviousEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));",
  "updateEachEncouragementReviewThatNeeded / if (reasonType !\u003d null \u0026\u0026 reasonType.getEncouragementTypeId() !\u003d null) / line2": "this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, entity.getEncouragementReviewRegistrarOrganizationId(), currentUserRole);",
  "updateEachEncouragementReviewThatNeeded / if (reasonType !\u003d null \u0026\u0026 reasonType.getEncouragementTypeId() !\u003d null) / line1": "if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_REVIEWER.getCode())) {\r\n    this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);\r\n} else {\r\n    if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode())) {\r\n        sendForVedjaCommission(encouragement, currentUser);\r\n        encouragementReviewService.updateExistEncouragementReview(entity, encouragement);\r\n    } else if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECT_TO_COMMISSION.getCode())) {\r\n        this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, null, currentUserRole);\r\n    } else {\r\n        //                            entity.setIsEncouragementReviewSeen(Boolean.TRUE);\r\n        if ((dto.getEncouragementReviewResult().equals(ReviewResultEnum.APPROVED.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) \u0026\u0026 entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_COMMISSION.getCode()))\r\n            this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);\r\n        else\r\n            this.changeEncouragementStatus(encouragement, dto.getEncouragementReviewResult(), currentUser.getPersonnelOrganizationID(), entity.getEncouragementReviewType());\r\n    }\r\n}",
  "calculator / if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) / line1": "amountOfEncouragementIsWithinThePowerLimits \u003d true;",
  "updateEachEncouragementReviewThatNeeded / if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_REVIEWER.getCode())) / line1": "this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);",
  "addOrUpdateEncouragement / if (request.getReasonId() !\u003d null \u0026\u0026 request.getType() !\u003d null \u0026\u0026 request.getType().getTypeId() !\u003d null) / line1": "reasonType \u003d this.findReasonType(request.getReasonId(), request.getType().getTypeId());",
  "sentForRegistrar / else / line1": "registrarEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));",
  "updateEncouragementReview / if (dto.getEncouragementReasonTypeId() !\u003d null) / line2": "validate(dto.getEncouragementAmount(), reasonType);",
  "calculator / if (personnelReviewCreator !\u003d null) / line1": "if (checkingRegistrarPowerLimits) {\r\n    if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) {\r\n        Integer encouragedPersonRank \u003d encouragedPerson.getPersonnelRankTypeCode();\r\n        boolean isGreaterThanSecondLieutenant \u003d encouragedPersonRank \u003e\u003d RankTypeEnum.SECOND_LIEUTENANT.getRankCode();\r\n        if (isGreaterThanSecondLieutenant) {\r\n            sendForVedjaCommission(encouragement, personnelReviewCreator);\r\n        } else\r\n            this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    } else {\r\n        Optional\u003cRegistrarPowerLimits\u003e optional \u003d registrarPowerLimitsService.getThisPersonnelOrganizationIdGroupAndEncouragementTypeId(registrarPowerLimitOrganizationId, typeId);\r\n        if (optional.isPresent()) {\r\n            boolean amountOfEncouragementIsWithinThePowerLimits \u003d false;\r\n            RegistrarPowerLimits powerLimits \u003d optional.get();\r\n            if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) {\r\n                amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n            } else {\r\n                if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) {\r\n                    amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n                }\r\n            }\r\n            if (amountOfEncouragementIsWithinThePowerLimits) {\r\n                this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n            } else {\r\n                if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) {\r\n                    this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                    afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                    //                                        forwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);\r\n                } else\r\n                    throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");\r\n            }\r\n        } else {\r\n            afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n        }\r\n    }\r\n} else {\r\n    afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n}",
  "updateEncouragementReview / if (dto.getEncouragementReasonTypeId() !\u003d null) / line1": "encouragementReview.setEncouragementReviewReasonTypeId(dto.getEncouragementReasonTypeId());",
  "updateEncouragementReview / if (entity.getEncouragementReviewRegistrarOrganizationId() \u003d\u003d null) / line1": "encouragementReview.setEncouragementReviewRegistrarOrganizationId(currentUser.getPersonnelOrganizationID());",
  "updateEncouragementReview / if (dto.getEncouragementReasonTypeId() !\u003d null) / line3": "encouragementReview.setEncouragementReviewReasonTypeId(dto.getEncouragementReasonTypeId());",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode())) / line2": "encouragementReviewService.updateExistEncouragementReview(entity, encouragement);",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode())) / line1": "sendForVedjaCommission(encouragement, currentUser);",
  "forwardEncouragementForNextStep / if (encouragementReviewList !\u003d null \u0026\u0026 encouragementReviewList.size() \u003e 0) / line1": "thisEncouragementReview \u003d encouragementReviewList.get(0);",
  "addOrUpdateEncouragement / if (list.isEmpty()) / line1": "this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);",
  "calculator / if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) / line1": "amountOfEncouragementIsWithinThePowerLimits \u003d true;",
  "commissionInput / else / line1": "updateExistEncouragement(commissionEncouragementReview.get(), encouragement);",
  "forwardNextManager / if (creatorIndex - 1 \u003e\u003d 0) / line3": "previousEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));",
  "forwardNextManager / if (creatorIndex - 1 \u003e\u003d 0) / line2": "Optional\u003cEncouragementReview\u003e previousEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(previousManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "forwardNextManager / else / line2": "thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));",
  "forwardNextManager / if (creatorIndex - 1 \u003e\u003d 0) / line1": "String previousManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 1);",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) \u0026\u0026 !dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line1": "if (dto.getEncouragementAmount() !\u003d null) {\r\n    encouragementReview.setEncouragementReviewAmount(dto.getEncouragementAmount());\r\n}",
  "forwardNextManager / else / line3": "thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) \u0026\u0026 !dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line2": "if (dto.getEncouragementAmountType() !\u003d null) {\r\n    encouragementReview.setEncouragementReviewAmountType(dto.getEncouragementAmountType());\r\n}",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) \u0026\u0026 !dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line3": "if (dto.getEncouragementReasonTypeId() !\u003d null) {\r\n    EncouragementReasonType reasonType \u003d encouragementReasonTypeService.findById(dto.getEncouragementReasonTypeId());\r\n    validate(dto.getEncouragementAmount(), reasonType);\r\n    encouragementReview.setEncouragementReviewReasonTypeId(dto.getEncouragementReasonTypeId());\r\n}",
  "forwardNextManager / else / line1": "if (encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())) {\r\n    Optional\u003cEncouragementReview\u003e commissionEncouragementReview \u003d encouragementReviewService.getAllCommissionReviewsForThisEncouragement(encouragement.getEncouragementId());\r\n    commissionEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));\r\n} else {\r\n    Optional\u003cEncouragementReview\u003e optional \u003d encouragementReviewService.getAllCommissionReviewsForThisEncouragement(encouragement.getEncouragementId());\r\n    if (optional.isEmpty()) {\r\n        commissionInput(encouragement, personnelManager.getPersonnelManagerOrganizationIdList().size() - 1 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) : null, personnelReviewCreator);\r\n    } else {\r\n        EncouragementReview commissionReview \u003d optional.get();\r\n        encouragementReviewService.updateExistEncouragementReview(commissionReview, encouragement);\r\n        thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n    }\r\n}",
  "updateEncouragementReview / if ((entity.getEncouragementReviewDraft() !\u003d null \u0026\u0026 entity.getEncouragementReviewDraft().equals(DraftEnum.Sent)) \u0026\u0026 (entity.getIsEncouragementReviewSeen() !\u003d null \u0026\u0026 entity.getIsEncouragementReviewSeen())) / line1": "throw new GeneralException(\"این بررسی تشویق ارسال و مشاهده شده و قابل ویرایش نمی باشد.\");",
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) / line1": "encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());",
  "afterCheckingRegistrarPowerLimit / else / line1": "throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");",
  "forwardEncouragementForNextStep / if ((currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue()) || creatorPositionInListOfManagersPosition.isEmpty()) \u0026\u0026 !encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode())) / line1": "commissionInput(encouragement, personnelManager.getPersonnelManagerOrganizationIdList().size() - 1 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) : null, personnelReviewCreator);",
  "addOrUpdateEncouragement / if (!encouragedPerson.getPersonnelMembershipCode().equals(MembershipType.PERMANENT.getCode())) / line1": "throw new ValidationException(\"شخص انتخاب شده، رسمی نمی باشد.\");",
  "forwardEncouragementForNextStep / if ((currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue()) || creatorPositionInListOfManagersPosition.isEmpty()) \u0026\u0026 !encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode())) / line2": "return;",
  "forwardNextManager / if (optional.isEmpty()) / line1": "commissionInput(encouragement, personnelManager.getPersonnelManagerOrganizationIdList().size() - 1 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) : null, personnelReviewCreator);",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line1": "if (dto.getEncouragementAmount() !\u003d null) {\r\n    encouragementReview.setEncouragementReviewAmount(dto.getEncouragementAmount());\r\n}",
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) / line3": "encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());",
  "calculator / else / line2": "if (optional.isPresent()) {\r\n    boolean amountOfEncouragementIsWithinThePowerLimits \u003d false;\r\n    RegistrarPowerLimits powerLimits \u003d optional.get();\r\n    if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) {\r\n        amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n    } else {\r\n        if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) {\r\n            amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n        }\r\n    }\r\n    if (amountOfEncouragementIsWithinThePowerLimits) {\r\n        this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n        afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n    } else {\r\n        if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) {\r\n            this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n            afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n            //                                        forwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);\r\n        } else\r\n            throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");\r\n    }\r\n} else {\r\n    afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n}",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line1": "Optional\u003cEncouragementReview\u003e nextEncouragementReview \u003d Optional.empty();",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line2": "if (dto.getEncouragementAmountType() !\u003d null) {\r\n    encouragementReview.setEncouragementReviewEncouragementAmountType(encouragement.getEncouragementAmountType());\r\n}",
  "calculator / else / line1": "throw new GeneralException(\"پارامتر ورودی صحیح نمی باشد .\");",
  "calculator / if (checkingRegistrarPowerLimits) / line1": "if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) {\r\n    Integer encouragedPersonRank \u003d encouragedPerson.getPersonnelRankTypeCode();\r\n    boolean isGreaterThanSecondLieutenant \u003d encouragedPersonRank \u003e\u003d RankTypeEnum.SECOND_LIEUTENANT.getRankCode();\r\n    if (isGreaterThanSecondLieutenant) {\r\n        sendForVedjaCommission(encouragement, personnelReviewCreator);\r\n    } else\r\n        this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n} else {\r\n    Optional\u003cRegistrarPowerLimits\u003e optional \u003d registrarPowerLimitsService.getThisPersonnelOrganizationIdGroupAndEncouragementTypeId(registrarPowerLimitOrganizationId, typeId);\r\n    if (optional.isPresent()) {\r\n        boolean amountOfEncouragementIsWithinThePowerLimits \u003d false;\r\n        RegistrarPowerLimits powerLimits \u003d optional.get();\r\n        if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) {\r\n            amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n        } else {\r\n            if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) {\r\n                amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n            }\r\n        }\r\n        if (amountOfEncouragementIsWithinThePowerLimits) {\r\n            this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n            afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n        } else {\r\n            if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) {\r\n                this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                //                                        forwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);\r\n            } else\r\n                throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");\r\n        }\r\n    } else {\r\n        afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n    }\r\n}",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line3": "if (dto.getEncouragementReasonTypeId() !\u003d null) {\r\n    encouragementReview.setEncouragementReviewReasonTypeId(dto.getEncouragementReasonTypeId());\r\n}",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line3": "String previousManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 1);",
  "forwardNextManager / if (creatorIndex + 1 \u003c managerPositionList.size()) / line4": "if (nextEncouragementReview.isPresent()) {\r\n    if (encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())) {\r\n        nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));\r\n    } else {\r\n        nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n        thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n    }\r\n} else if (!(encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())))\r\n    this.createReviewFromEncouragement(encouragement, nextManagerOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex));",
  "updateEncouragementReview / if (dto.getEncouragementAmount() !\u003d null) / line1": "encouragementReview.setEncouragementReviewAmount(dto.getEncouragementAmount());",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line2": "String nextManagerOrganizationId \u003d null;",
  "forwardNextManager / if (creatorIndex + 1 \u003c managerPositionList.size()) / line3": "if (creatorIndex - 1 \u003e\u003d 0) {\r\n    String previousManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 1);\r\n    Optional\u003cEncouragementReview\u003e previousEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(previousManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    previousEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));\r\n}",
  "addOrUpdateEncouragement / if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent)) / line1": "encouragement.setEncouragementSentDraftDate(LocalDate.now());",
  "addOrUpdateEncouragement / else / line1": "throw new GeneralException(\"پارامتر ورودی صحیح نمی باشد .\");",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line5": "if (creatorIndex + 1 \u003c\u003d personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) {\r\n    nextManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex + 1);\r\n    nextEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(nextManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));\r\n}",
  "forwardNextManager / if (creatorIndex + 1 \u003c managerPositionList.size()) / line2": "Optional\u003cEncouragementReview\u003e nextEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(nextManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "addOrUpdateEncouragement / else / line2": "if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n    EncouragementReview encouragementReview \u003d list.get(0);\r\n    encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n    encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n}",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line4": "Optional\u003cEncouragementReview\u003e previousEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(previousManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "forwardNextManager / if (creatorIndex + 1 \u003c managerPositionList.size()) / line1": "String nextManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex + 1);",
  "updateEncouragementReview / if (dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line1": "if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) {\r\n    if (dto.getEncouragementAmount() !\u003d null)\r\n        encouragement.setEncouragementAmount(dto.getEncouragementAmount());\r\n    if (dto.getEncouragementAmountType() !\u003d null) {\r\n        encouragement.setEncouragementAmountType(dto.getEncouragementAmountType());\r\n    }\r\n    if (dto.getEncouragementReasonTypeId() !\u003d null) {\r\n        EncouragementReasonType reasonType \u003d encouragementReasonTypeService.findById(dto.getEncouragementReasonTypeId());\r\n        validate(dto.getEncouragementAmount(), reasonType);\r\n        encouragement.setEncouragementReasonTypeId(dto.getEncouragementReasonTypeId());\r\n    }\r\n    if (// تاریخ تصویب وارد شده توسط کاربر همان تاریخ تصویب حقیقی تشویق؟\r\n    dto.getEncouragementReviewAppliedDate() !\u003d null)\r\n        encouragement.setEncouragementAppliedDate(dto.getEncouragementReviewAppliedDate());\r\n    //                    this.changeEncouragementStatus(encouragement, dto.getEncouragementReviewResult(), null);\r\n}",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line7": "Optional\u003cEncouragementReview\u003e commissionEncouragementReview \u003d encouragementReviewService.getAllCommissionReviewsForThisEncouragement(encouragement.getEncouragementId());",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line6": "if (thisEncouragementReview.isPresent()) {\r\n    EncouragementReview review \u003d thisEncouragementReview.get();\r\n    if (review.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode())) {\r\n        if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId()))\r\n            changeEncouragementStatus(encouragement, EncouragementResultEnum.SENT_FOR_CORRECTION.getCode(), null, null);\r\n    }\r\n}",
  "forwardNextManager / if (!(encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode()))) / line1": "this.createReviewFromEncouragement(encouragement, nextManagerOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex));",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line9": "if (!encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode())) {\r\n    if (previousEncouragementReview.isEmpty() \u0026\u0026 encouragement.getIsEncouragementSeen()) {\r\n        this.createReviewFromEncouragement(encouragement, previousManagerOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), creatorIndex - 2 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 2) : null);\r\n        if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId())) {\r\n            sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);\r\n        }\r\n    } else {\r\n        if (!encouragement.getIsEncouragementSeen()) {\r\n            sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);\r\n        } else {\r\n            if (previousEncouragementReview.isPresent()) {\r\n                EncouragementReview review \u003d previousEncouragementReview.get();\r\n                if (deleteRecentManagerReview) {\r\n                    encouragementReviewService.deleteEncouragementReview(review.getEncouragementReviewId());\r\n                    forwardNextManager(encouragement, personnelReviewCreator, personnelManager, managerPositionList, creatorIndex, thisEncouragementReview, deleteRecentManagerReview, encouragedPerson);\r\n                } else {\r\n                    if (!encouragement.getEncouragementRegistrarOrganizationId().equals(review.getEncouragementReviewRegistrarOrganizationId()))\r\n                        encouragementReviewService.updateExistEncouragementReview(review, encouragement);\r\n                }\r\n            }\r\n            thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n        }\r\n    }\r\n} else {\r\n    List\u003cEncouragementReview\u003e approvedNextEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(nextManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    if (!approvedNextEncouragementReview.isEmpty())\r\n        encouragementReviewService.deleteEncouragementReview(approvedNextEncouragementReview.get(0).getEncouragementReviewId());\r\n}",
  "forwardPreviousManager / if (creatorIndex - 1 \u003e\u003d 0) / line8": "commissionEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));",
  "forwardPreviousManager / if (!encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode())) / line1": "if (previousEncouragementReview.isEmpty() \u0026\u0026 encouragement.getIsEncouragementSeen()) {\r\n    this.createReviewFromEncouragement(encouragement, previousManagerOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), creatorIndex - 2 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 2) : null);\r\n    if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId())) {\r\n        sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);\r\n    }\r\n} else {\r\n    if (!encouragement.getIsEncouragementSeen()) {\r\n        sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);\r\n    } else {\r\n        if (previousEncouragementReview.isPresent()) {\r\n            EncouragementReview review \u003d previousEncouragementReview.get();\r\n            if (deleteRecentManagerReview) {\r\n                encouragementReviewService.deleteEncouragementReview(review.getEncouragementReviewId());\r\n                forwardNextManager(encouragement, personnelReviewCreator, personnelManager, managerPositionList, creatorIndex, thisEncouragementReview, deleteRecentManagerReview, encouragedPerson);\r\n            } else {\r\n                if (!encouragement.getEncouragementRegistrarOrganizationId().equals(review.getEncouragementReviewRegistrarOrganizationId()))\r\n                    encouragementReviewService.updateExistEncouragementReview(review, encouragement);\r\n            }\r\n        }\r\n        thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n    }\r\n}",
  "forwardNextManager / if (encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())) / line2": "commissionEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));",
  "forwardNextManager / if (encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())) / line1": "nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));",
  "calculator / if (optional.isPresent()) / line1": "boolean amountOfEncouragementIsWithinThePowerLimits \u003d false;",
  "afterCheckingRegistrarPowerLimit / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) / line1": "//            List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(personnelReviewCreator.getPersonnelOrganizationID(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n//            if (list.isEmpty())\r\n//                this.createReviewFromEncouragement(encouragement, personnelReviewCreator.getPersonnelOrganizationID(), ReviewResultEnum.APPROVED.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Sent.getCode(), null);\r\nforwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);",
  "forwardPreviousManager / if (thisEncouragementReview.isPresent()) / line2": "if (review.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode())) {\r\n    if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId()))\r\n        changeEncouragementStatus(encouragement, EncouragementResultEnum.SENT_FOR_CORRECTION.getCode(), null, null);\r\n}",
  "calculator / if (optional.isPresent()) / line2": "RegistrarPowerLimits powerLimits \u003d optional.get();",
  "forwardPreviousManager / if (thisEncouragementReview.isPresent()) / line1": "EncouragementReview review \u003d thisEncouragementReview.get();",
  "calculator / if (optional.isPresent()) / line3": "if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) {\r\n    amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n} else {\r\n    if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) {\r\n        amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n    }\r\n}",
  "calculator / if (optional.isPresent()) / line4": "if (amountOfEncouragementIsWithinThePowerLimits) {\r\n    this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n} else {\r\n    if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) {\r\n        this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n        afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n        //                                        forwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);\r\n    } else\r\n        throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");\r\n}",
  "updateEachEncouragementReviewThatNeeded / else / line1": "if (dto.getEncouragementReviewResult() !\u003d null \u0026\u0026 dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECTED.getCode())) {\r\n    if (dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n        if (reasonType !\u003d null \u0026\u0026 reasonType.getEncouragementTypeId() !\u003d null) {\r\n            this.changeEncouragementStatus(encouragement, EncouragementResultEnum.REJECTED.getCode(), currentUser.getPersonnelOrganizationID(), entity.getEncouragementReviewType());\r\n            this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, entity.getEncouragementReviewRegistrarOrganizationId(), currentUserRole);\r\n        }\r\n    }\r\n} else if (dto.getEncouragementReviewResult() !\u003d null) {\r\n    if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n        encouragement.setIsEncouragementSeen(Boolean.FALSE);\r\n        this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n    }\r\n    if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n        deleteRegistrarReviewIfExist(encouragement);\r\n        this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, entity.getEncouragementReviewPreviousOrganizationId(), currentUserRole);\r\n    }\r\n}",
  "updateEncouragementReview / if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_COMMISSION.getCode())) / line1": "optional \u003d encouragementReviewService.getAllCommissionReviewsForThisEncouragement(encouragement.getEncouragementId());",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line1": "if (reasonType !\u003d null \u0026\u0026 reasonType.getEncouragementTypeId() !\u003d null) {\r\n    if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_REVIEWER.getCode())) {\r\n        this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);\r\n    } else {\r\n        if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode())) {\r\n            sendForVedjaCommission(encouragement, currentUser);\r\n            encouragementReviewService.updateExistEncouragementReview(entity, encouragement);\r\n        } else if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECT_TO_COMMISSION.getCode())) {\r\n            this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, null, currentUserRole);\r\n        } else {\r\n            //                            entity.setIsEncouragementReviewSeen(Boolean.TRUE);\r\n            if ((dto.getEncouragementReviewResult().equals(ReviewResultEnum.APPROVED.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) \u0026\u0026 entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_COMMISSION.getCode()))\r\n                this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);\r\n            else\r\n                this.changeEncouragementStatus(encouragement, dto.getEncouragementReviewResult(), currentUser.getPersonnelOrganizationID(), entity.getEncouragementReviewType());\r\n        }\r\n    }\r\n}",
  "forwardPreviousManager / if (deleteRecentManagerReview) / line1": "encouragementReviewService.deleteEncouragementReview(review.getEncouragementReviewId());",
  "updateEachEncouragementReviewThatNeeded / if ((dto.getEncouragementReviewResult().equals(ReviewResultEnum.APPROVED.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) \u0026\u0026 entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_COMMISSION.getCode())) / line1": "this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);",
  "forwardPreviousManager / if (deleteRecentManagerReview) / line2": "forwardNextManager(encouragement, personnelReviewCreator, personnelManager, managerPositionList, creatorIndex, thisEncouragementReview, deleteRecentManagerReview, encouragedPerson);",
  "updateEncouragementReview / if (entity.getEncouragementReviewId() !\u003d null) / line1": "FileAttachmentDTO fileAttachmentDTO \u003d FileAttachmentDTO.builder().encouragementReviewId(entity.getEncouragementReviewId()).build();",
  "updateEncouragementReview / if (entity.getEncouragementReviewId() !\u003d null) / line2": "addFile(fileList, deleteFileIdList, fileAttachmentDTO);",
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) / line1": "EncouragementReview encouragementReview \u003d list.get(0);",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) / line3": "if (dto.getEncouragementReasonTypeId() !\u003d null) {\r\n    EncouragementReasonType reasonType \u003d encouragementReasonTypeService.findById(dto.getEncouragementReasonTypeId());\r\n    validate(dto.getEncouragementAmount(), reasonType);\r\n    encouragement.setEncouragementReasonTypeId(dto.getEncouragementReasonTypeId());\r\n}",
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) / line2": "encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) / line2": "if (dto.getEncouragementAmountType() !\u003d null) {\r\n    encouragement.setEncouragementAmountType(dto.getEncouragementAmountType());\r\n}",
  "forwardEncouragementForNextStep / if (nextManager) / line1": "forwardNextManager(encouragement, personnelReviewCreator, personnelManager, managerPositionList, creatorIndex, Optional.ofNullable(thisEncouragementReview), deleteRecentManagerReview, encouragedPerson);",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) / line4": "if (// تاریخ تصویب وارد شده توسط کاربر همان تاریخ تصویب حقیقی تشویق؟\r\ndto.getEncouragementReviewAppliedDate() !\u003d null)\r\n    encouragement.setEncouragementAppliedDate(dto.getEncouragementReviewAppliedDate());",
  "updateEncouragementReview / if (dto.getEncouragementAmountType() !\u003d null) / line1": "encouragementReview.setEncouragementReviewEncouragementAmountType(encouragement.getEncouragementAmountType());",
  "updateEncouragementReview / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) / line1": "if (dto.getEncouragementAmount() !\u003d null)\r\n    encouragement.setEncouragementAmount(dto.getEncouragementAmount());",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECT_TO_COMMISSION.getCode())) / line1": "this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, null, currentUserRole);",
  "updateEachEncouragementReviewThatNeeded / if (entity.getIsEncouragementReviewSeen()) / line1": "throw new GeneralException(\"این بررسی مشاهده شده است و قابل ویرایش نمی باشد.\");",
  "forwardPreviousManager / if (review.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode())) / line1": "if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId()))\r\n    changeEncouragementStatus(encouragement, EncouragementResultEnum.SENT_FOR_CORRECTION.getCode(), null, null);",
  "calculator / if (isGreaterThanSecondLieutenant) / line1": "sendForVedjaCommission(encouragement, personnelReviewCreator);",
  "forwardNextManager / if (deleteRecentManagerReview) / line1": "deleteRegistrarReviewIfExist(encouragement);",
  "forwardPreviousManager / if (creatorIndex + 1 \u003c\u003d personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) / line2": "nextEncouragementReview \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithUnderReviewStatusAndReviewerType(nextManagerOrganizationId, encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "forwardPreviousManager / if (creatorIndex + 1 \u003c\u003d personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) / line1": "nextManagerOrganizationId \u003d personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex + 1);",
  "forwardPreviousManager / if (!approvedNextEncouragementReview.isEmpty()) / line1": "encouragementReviewService.deleteEncouragementReview(approvedNextEncouragementReview.get(0).getEncouragementReviewId());",
  "forwardPreviousManager / if (previousEncouragementReview.isPresent()) / line1": "EncouragementReview review \u003d previousEncouragementReview.get();",
  "forwardPreviousManager / if (creatorIndex + 1 \u003c\u003d personnelManager.getPersonnelManagerOrganizationIdList().size() - 1) / line3": "nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));",
  "forwardPreviousManager / if (previousEncouragementReview.isPresent()) / line2": "if (deleteRecentManagerReview) {\r\n    encouragementReviewService.deleteEncouragementReview(review.getEncouragementReviewId());\r\n    forwardNextManager(encouragement, personnelReviewCreator, personnelManager, managerPositionList, creatorIndex, thisEncouragementReview, deleteRecentManagerReview, encouragedPerson);\r\n} else {\r\n    if (!encouragement.getEncouragementRegistrarOrganizationId().equals(review.getEncouragementReviewRegistrarOrganizationId()))\r\n        encouragementReviewService.updateExistEncouragementReview(review, encouragement);\r\n}",
  "forwardPreviousManager / else / line1": "throw new GeneralException(\"مدیر قبلی ایی وجود ندارد.\");",
  "forwardPreviousManager / else / line2": "if (!approvedNextEncouragementReview.isEmpty())\r\n    encouragementReviewService.deleteEncouragementReview(approvedNextEncouragementReview.get(0).getEncouragementReviewId());",
  "commissionInput / if (!encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) / line1": "this.changeEncouragementStatus(encouragement, EncouragementResultEnum.UNDER_COMMISSION_REVIEW.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_COMMISSION.getCode());",
  "forwardPreviousManager / if (!encouragement.getIsEncouragementSeen()) / line1": "sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);",
  "forwardNextManager / if (nextEncouragementReview.isPresent()) / line1": "if (encouragement.getEncouragementStatus().equals(EncouragementResultEnum.REJECTED.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.APPROVED.getCode())) {\r\n    nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.deleteEncouragementReview(encouragementReview.getEncouragementReviewId()));\r\n} else {\r\n    nextEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n    thisEncouragementReview.ifPresent(encouragementReview -\u003e encouragementReviewService.updateExistEncouragementReview(encouragementReview, encouragement));\r\n}",
  "addOrUpdateEncouragement / if (!encouragement.getIsEncouragementSeen()) / line4": "encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);",
  "addOrUpdateEncouragement / if (!encouragement.getIsEncouragementSeen()) / line3": "if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n    encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n}",
  "addOrUpdateEncouragement / if (!encouragement.getIsEncouragementSeen()) / line2": "if (list.isEmpty()) {\r\n    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n} else {\r\n    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n        EncouragementReview encouragementReview \u003d list.get(0);\r\n        encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n        encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n    }\r\n}",
  "addOrUpdateEncouragement / if (!encouragement.getIsEncouragementSeen()) / line1": "List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "addOrUpdateEncouragement / if (request.getEncouragementDraft() !\u003d null \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) / line1": "if (!encouragement.getIsEncouragementSeen()) {\r\n    List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    if (list.isEmpty()) {\r\n        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n    } else {\r\n        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n        if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n            EncouragementReview encouragementReview \u003d list.get(0);\r\n            encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n            encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n        }\r\n    }\r\n    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n        encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n    }\r\n    encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);\r\n} else\r\n    throw new GeneralException(\"این تشویق مشاهده شده و قابل ویرایش نیست\");",
  "addOrUpdateEncouragement / if (!resultList.isEmpty() \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) / line1": "resultList.forEach(encouragement -\u003e {\r\n    try {\r\n        if (request.getEncouragementDraft() !\u003d null \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) {\r\n            if (!encouragement.getIsEncouragementSeen()) {\r\n                List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                if (list.isEmpty()) {\r\n                    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                } else {\r\n                    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n                        EncouragementReview encouragementReview \u003d list.get(0);\r\n                        encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n                        encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n                    }\r\n                }\r\n                if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n                    encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n                }\r\n                encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);\r\n            } else\r\n                throw new GeneralException(\"این تشویق مشاهده شده و قابل ویرایش نیست\");\r\n        }\r\n    } catch (Exception e) {\r\n        throw new RuntimeException(e);\r\n    }\r\n});",
  "forwardEncouragementForNextStep / else / line1": "forwardPreviousManager(encouragement, personnelReviewCreator, personnelManager, managerPositionList, creatorIndex, Optional.ofNullable(thisEncouragementReview), deleteRecentManagerReview, encouragedPerson);",
  "forwardPreviousManager / if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId())) / line1": "sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult() !\u003d null \u0026\u0026 dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECTED.getCode())) / line1": "if (dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n    if (reasonType !\u003d null \u0026\u0026 reasonType.getEncouragementTypeId() !\u003d null) {\r\n        this.changeEncouragementStatus(encouragement, EncouragementResultEnum.REJECTED.getCode(), currentUser.getPersonnelOrganizationID(), entity.getEncouragementReviewType());\r\n        this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, entity.getEncouragementReviewRegistrarOrganizationId(), currentUserRole);\r\n    }\r\n}",
  "addOrUpdateEncouragement / if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent)) / line1": "encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());",
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode())) / line1": "encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());",
  "calculator / if (encouragement !\u003d null) / line2": "if (encouragedPerson !\u003d null) {\r\n    if (personnelReviewCreator !\u003d null) {\r\n        if (checkingRegistrarPowerLimits) {\r\n            if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) {\r\n                Integer encouragedPersonRank \u003d encouragedPerson.getPersonnelRankTypeCode();\r\n                boolean isGreaterThanSecondLieutenant \u003d encouragedPersonRank \u003e\u003d RankTypeEnum.SECOND_LIEUTENANT.getRankCode();\r\n                if (isGreaterThanSecondLieutenant) {\r\n                    sendForVedjaCommission(encouragement, personnelReviewCreator);\r\n                } else\r\n                    this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n            } else {\r\n                Optional\u003cRegistrarPowerLimits\u003e optional \u003d registrarPowerLimitsService.getThisPersonnelOrganizationIdGroupAndEncouragementTypeId(registrarPowerLimitOrganizationId, typeId);\r\n                if (optional.isPresent()) {\r\n                    boolean amountOfEncouragementIsWithinThePowerLimits \u003d false;\r\n                    RegistrarPowerLimits powerLimits \u003d optional.get();\r\n                    if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) {\r\n                        amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n                    } else {\r\n                        if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) {\r\n                            amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n                        }\r\n                    }\r\n                    if (amountOfEncouragementIsWithinThePowerLimits) {\r\n                        this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                        afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                    } else {\r\n                        if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) {\r\n                            this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                            afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                            //                                        forwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);\r\n                        } else\r\n                            throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");\r\n                    }\r\n                } else {\r\n                    afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                }\r\n            }\r\n        } else {\r\n            afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n        }\r\n    } else\r\n        throw new GeneralException(\"شخص تشویق کننده یافت نشد .\");\r\n} else\r\n    throw new GeneralException(\"شخص تشویق شونده یافت نشد .\");",
  "afterCheckingRegistrarPowerLimit / if (!isUpdateMode) / line1": "this.createReviewFromEncouragement(encouragement, personnelReviewCreator.getPersonnelOrganizationID(), ReviewResultEnum.APPROVED.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Sent.getCode(), null);",
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) / line1": "if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n    encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\nelse {\r\n    if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n        encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n    if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n        encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n}",
  "forwardPreviousManager / if (previousEncouragementReview.isEmpty() \u0026\u0026 encouragement.getIsEncouragementSeen()) / line2": "if (previousManagerOrganizationId.equals(encouragement.getEncouragementRegistrarOrganizationId())) {\r\n    sentForRegistrar(encouragement, personnelManager, creatorIndex, previousManagerOrganizationId);\r\n}",
  "calculator / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) / line1": "this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "calculator / if (encouragement !\u003d null) / line1": "PersonnelDTO encouragedPerson \u003d (PersonnelDTO) personnelService.findByOrganizationId(encouragement.getEncouragementPersonnelOrganizationId(), typeOfPersonnelDTOWithManagerSending);",
  "forwardPreviousManager / if (previousEncouragementReview.isEmpty() \u0026\u0026 encouragement.getIsEncouragementSeen()) / line1": "this.createReviewFromEncouragement(encouragement, previousManagerOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), creatorIndex - 2 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(creatorIndex - 2) : null);",
  "calculator / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) / line2": "afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);",
  "updateEncouragementReview / if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.VEDJA_COMMISSION.getCode())) / line1": "optional \u003d encouragementReviewService.getAllVedjaReviewsForThisEncouragement(encouragement.getEncouragementId());",
  "updateEncouragementReview / else / line1": "if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.VEDJA_COMMISSION.getCode()))\r\n    optional \u003d encouragementReviewService.getAllVedjaReviewsForThisEncouragement(encouragement.getEncouragementId());",
  "addOrUpdateEncouragement / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) / line2": "encouragement.setEncouragementTypeCategory(TypeCategoryEnum.NORMAL);",
  "addOrUpdateEncouragement / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) / line1": "Encouragement encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId);",
  "addOrUpdateEncouragement / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) / line4": "encouragements.add(encouragement);",
  "addOrUpdateEncouragement / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) / line3": "if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n    if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n        encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\n    else {\r\n        if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n            encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n        if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n            encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n    }\r\n}",
  "commissionInput / if (commissionEncouragementReview.isEmpty()) / line1": "createReviewFromEncouragement(encouragement, null, ReviewResultEnum.UNDER_COMMISSION_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_COMMISSION.getCode(), DraftEnum.Nothing.getCode(), personnelManager);",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line1": "deleteRegistrarReviewIfExist(encouragement);",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line2": "this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, entity.getEncouragementReviewPreviousOrganizationId(), currentUserRole);",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult() !\u003d null) / line2": "if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_RECENT_MANAGER_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n    deleteRegistrarReviewIfExist(encouragement);\r\n    this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, entity.getEncouragementReviewPreviousOrganizationId(), currentUserRole);\r\n}",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line1": "List\u003cEncouragement\u003e encouragements \u003d new ArrayList\u003c\u003e();",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult() !\u003d null \u0026\u0026 (dto.getEncouragementReviewResult().equals(ReviewResultEnum.APPROVED.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECT_TO_COMMISSION.getCode()))) / line1": "if (dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n    if (reasonType !\u003d null \u0026\u0026 reasonType.getEncouragementTypeId() !\u003d null) {\r\n        if (entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_REVIEWER.getCode())) {\r\n            this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);\r\n        } else {\r\n            if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_ENCOURAGEMENT_SPECIALIST.getCode())) {\r\n                sendForVedjaCommission(encouragement, currentUser);\r\n                encouragementReviewService.updateExistEncouragementReview(entity, encouragement);\r\n            } else if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.REJECT_TO_COMMISSION.getCode())) {\r\n                this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, false, null, currentUserRole);\r\n            } else {\r\n                //                            entity.setIsEncouragementReviewSeen(Boolean.TRUE);\r\n                if ((dto.getEncouragementReviewResult().equals(ReviewResultEnum.APPROVED.getCode()) || dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode())) \u0026\u0026 entity.getEncouragementReviewType().equals(ReviewTypeEnum.ORDINARY_COMMISSION.getCode()))\r\n                    this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), true, true, true, currentUser.getPersonnelOrganizationID(), currentUserRole);\r\n                else\r\n                    this.changeEncouragementStatus(encouragement, dto.getEncouragementReviewResult(), currentUser.getPersonnelOrganizationID(), entity.getEncouragementReviewType());\r\n            }\r\n        }\r\n    }\r\n}",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line5": "for (String personnelOrganizationId : request.getEncouragementRelatedPersonnelOrganizationIds()) {\r\n    PersonnelDTO encouragedPerson \u003d (PersonnelDTO) personnelService.findByOrganizationId(personnelOrganizationId, typeOfPersonnelDTOWithManagerSending);\r\n    if (!encouragedPerson.getPersonnelMembershipCode().equals(MembershipType.PERMANENT.getCode()))\r\n        throw new ValidationException(\"شخص انتخاب شده، رسمی نمی باشد.\");\r\n    /**\r\n     * @CheckBothAreExistsInSameOrganization\r\n     */\r\n    if ((registrar.getPersonnelUnitCode() \u003d\u003d null || encouragedPerson.getPersonnelUnitCode() \u003d\u003d null) || Objects.equals(registrar.getPersonnelUnitCode(), encouragedPerson.getPersonnelUnitCode())) {\r\n        /**\r\n         * @CheckExistsRegistrarInPersonnelManager\r\n         */\r\n        if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) {\r\n            Encouragement encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId);\r\n            encouragement.setEncouragementTypeCategory(TypeCategoryEnum.NORMAL);\r\n            if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n                if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n                    encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\n                else {\r\n                    if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n                        encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n                    if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n                        encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n                }\r\n            }\r\n            encouragements.add(encouragement);\r\n        } else\r\n            throw new GeneralException(String.format(\"شما در سلسله مراتب پرسنل %s قرار ندارید.\", encouragedPerson.getPersonnelOrganizationID()));\r\n    } else\r\n        throw new GeneralException(String.format(\"تشویق شونده ی %s در یگان شما نمی باشد.\", encouragedPerson.getPersonnelOrganizationID()));\r\n}",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line4": "validate(request.getAmount(), reasonType);",
  "updateEncouragementReview / if (((dto.getEncouragementAmount() !\u003d null \u0026\u0026 !dto.getEncouragementAmount().equals(encouragement.getEncouragementAmount())) || (dto.getEncouragementAmountType() !\u003d null \u0026\u0026 !dto.getEncouragementAmountType().equals(encouragement.getEncouragementAmountType())) || (dto.getEncouragementReasonTypeId() !\u003d null \u0026\u0026 !dto.getEncouragementReasonTypeId().equals(encouragement.getEncouragementReasonTypeId()))) \u0026\u0026 !(dto.getEncouragementReviewResult().equals(ReviewResultEnum.CORRECTION_AND_APPROVAL.getCode()))) / line1": "throw new GeneralException(\" فقط در وضعیت اصلاح و تایید، می توانید نوع و میزان را تغییر دهید.\");",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line3": "if (request.getReasonId() !\u003d null \u0026\u0026 request.getType() !\u003d null \u0026\u0026 request.getType().getTypeId() !\u003d null)\r\n    reasonType \u003d this.findReasonType(request.getReasonId(), request.getType().getTypeId());",
  "calculator / if (encouragedPerson !\u003d null) / line1": "if (personnelReviewCreator !\u003d null) {\r\n    if (checkingRegistrarPowerLimits) {\r\n        if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) {\r\n            Integer encouragedPersonRank \u003d encouragedPerson.getPersonnelRankTypeCode();\r\n            boolean isGreaterThanSecondLieutenant \u003d encouragedPersonRank \u003e\u003d RankTypeEnum.SECOND_LIEUTENANT.getRankCode();\r\n            if (isGreaterThanSecondLieutenant) {\r\n                sendForVedjaCommission(encouragement, personnelReviewCreator);\r\n            } else\r\n                this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n        } else {\r\n            Optional\u003cRegistrarPowerLimits\u003e optional \u003d registrarPowerLimitsService.getThisPersonnelOrganizationIdGroupAndEncouragementTypeId(registrarPowerLimitOrganizationId, typeId);\r\n            if (optional.isPresent()) {\r\n                boolean amountOfEncouragementIsWithinThePowerLimits \u003d false;\r\n                RegistrarPowerLimits powerLimits \u003d optional.get();\r\n                if ((encouragement.getEncouragementAmount() \u003d\u003d null \u0026\u0026 powerLimits.getMaxAmount() \u003d\u003d null)) {\r\n                    amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n                } else {\r\n                    if (encouragement.getEncouragementAmount() !\u003d null \u0026\u0026 (powerLimits.getMaxAmount().compareTo(BigDecimal.valueOf(encouragement.getEncouragementAmount())) \u003e\u003d 0 || powerLimits.getMaxDuration() !\u003d null \u0026\u0026 powerLimits.getMaxDuration().compareTo(Math.toIntExact(encouragement.getEncouragementAmount())) \u003e\u003d 0)) {\r\n                        amountOfEncouragementIsWithinThePowerLimits \u003d true;\r\n                    }\r\n                }\r\n                if (amountOfEncouragementIsWithinThePowerLimits) {\r\n                    this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                    afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                } else {\r\n                    if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 draft.equals(DraftEnum.Sent.getCode())) {\r\n                        this.changeEncouragementStatus(encouragement, EncouragementResultEnum.NEED_FOR_ACCEPT.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                        afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n                        //                                        forwardEncouragementForNextStep(encouragement, personnelReviewCreator, encouragedPerson, nextManager, deleteRecentManagerReview, currentUserRole);\r\n                    } else\r\n                        throw new GeneralException(\"لیست مدیران شخص وارد شده خالی می باشد .\");\r\n                }\r\n            } else {\r\n                afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n            }\r\n        }\r\n    } else {\r\n        afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);\r\n    }\r\n} else\r\n    throw new GeneralException(\"شخص تشویق کننده یافت نشد .\");",
  "sentForRegistrar / if (registrarEncouragementReview.isEmpty()) / line1": "this.createReviewFromEncouragement(encouragement, registrarOrganizationId, ReviewResultEnum.UNDER_REVIEW.getCode(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode(), DraftEnum.Nothing.getCode(), registrarOrgIdIndex - 1 \u003e\u003d 0 ? personnelManager.getPersonnelManagerOrganizationIdList().get(registrarOrgIdIndex - 1) : null);",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line2": "EncouragementReasonType reasonType \u003d null;",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult() !\u003d null) / line1": "if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) {\r\n    encouragement.setIsEncouragementSeen(Boolean.FALSE);\r\n    this.calculator(encouragement, reasonType.getEncouragementTypeId(), currentUser, Boolean.TRUE, dto.getEncouragementReviewDraft(), false, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n}",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line8": "return resultList;",
  "updateEncouragementReview / if (entity \u003d\u003d null) / line1": "throw new GeneralException(\"بررسی تشویق مربوطه یافت نشد.\");",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line7": "if (!resultList.isEmpty() \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) {\r\n    resultList.forEach(encouragement -\u003e {\r\n        try {\r\n            if (request.getEncouragementDraft() !\u003d null \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) {\r\n                if (!encouragement.getIsEncouragementSeen()) {\r\n                    List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                    if (list.isEmpty()) {\r\n                        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                    } else {\r\n                        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                        if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n                            EncouragementReview encouragementReview \u003d list.get(0);\r\n                            encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n                            encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n                        }\r\n                    }\r\n                    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n                        encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n                    }\r\n                    encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);\r\n                } else\r\n                    throw new GeneralException(\"این تشویق مشاهده شده و قابل ویرایش نیست\");\r\n            }\r\n        } catch (Exception e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    });\r\n}",
  "updateEachEncouragementReviewThatNeeded / if (dto.getEncouragementReviewResult().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) \u0026\u0026 dto.getEncouragementReviewDraft().equals(DraftEnum.Sent.getCode())) / line1": "encouragement.setIsEncouragementSeen(Boolean.FALSE);",
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null) / line6": "List\u003cEncouragement\u003e resultList \u003d encouragementRepository.saveAll(encouragements);",
  "calculator / if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) / line3": "if (isGreaterThanSecondLieutenant) {\r\n    sendForVedjaCommission(encouragement, personnelReviewCreator);\r\n} else\r\n    this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "calculator / if (amountOfEncouragementIsWithinThePowerLimits) / line1": "this.changeEncouragementStatus(encouragement, EncouragementResultEnum.APPROVED.getCode(), personnelReviewCreator.getPersonnelOrganizationID(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
  "calculator / if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) / line1": "Integer encouragedPersonRank \u003d encouragedPerson.getPersonnelRankTypeCode();",
  "calculator / if (amountOfEncouragementIsWithinThePowerLimits) / line2": "afterCheckingRegistrarPowerLimit(encouragement, personnelReviewCreator, isUpdateMode, draft, nextManager, deleteRecentManagerReview, encouragedPerson, currentUserRole);",
  "calculator / if (currentUserRole.equals(RoleConstant.ROLE.ENCOURAGEMENT_SPECIALIST.getValue())) / line2": "boolean isGreaterThanSecondLieutenant \u003d encouragedPersonRank \u003e\u003d RankTypeEnum.SECOND_LIEUTENANT.getRankCode();",
  "forwardPreviousManager / if (!encouragement.getEncouragementRegistrarOrganizationId().equals(review.getEncouragementReviewRegistrarOrganizationId())) / line1": "encouragementReviewService.updateExistEncouragementReview(review, encouragement);"
}