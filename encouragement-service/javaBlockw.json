{
  "addOrUpdateEncouragement / if (request.getReasonId() !\u003d null \u0026\u0026 request.getType() !\u003d null \u0026\u0026 request.getType().getTypeId() !\u003d null)": [
    "reasonType \u003d this.findReasonType(request.getReasonId(), request.getType().getTypeId());"
  ],
  "addOrUpdateEncouragement / if (!encouragedPerson.getPersonnelMembershipCode().equals(MembershipType.PERMANENT.getCode()))": [
    "throw new ValidationException(\"شخص انتخاب شده، رسمی نمی باشد.\");"
  ],
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))": [
    "encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());"
  ],
  "addOrUpdateEncouragement / if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))": [
    "encouragement.setEncouragementSentDraftDate(LocalDate.now());"
  ],
  "addOrUpdateEncouragement / if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))": [
    "encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());"
  ],
  "addOrUpdateEncouragement / else": [
    "throw new GeneralException(\"پارامتر ورودی صحیح نمی باشد .\");"
  ],
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()))": [
    "if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n    encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\nelse {\r\n    if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n        encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n    if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n        encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n}"
  ],
  "addOrUpdateEncouragement / if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID())))": [
    "Encouragement encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId);",
    "encouragement.setEncouragementTypeCategory(TypeCategoryEnum.NORMAL);",
    "if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n    if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n        encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\n    else {\r\n        if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n            encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n        if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n            encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n    }\r\n}",
    "encouragements.add(encouragement);"
  ],
  "addOrUpdateEncouragement / if ((registrar.getPersonnelUnitCode() \u003d\u003d null || encouragedPerson.getPersonnelUnitCode() \u003d\u003d null) || Objects.equals(registrar.getPersonnelUnitCode(), encouragedPerson.getPersonnelUnitCode()))": [
    "/**\r\n * @CheckExistsRegistrarInPersonnelManager\r\n */\r\nif (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) {\r\n    Encouragement encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId);\r\n    encouragement.setEncouragementTypeCategory(TypeCategoryEnum.NORMAL);\r\n    if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n        if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n            encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\n        else {\r\n            if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n                encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n            if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n                encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n        }\r\n    }\r\n    encouragements.add(encouragement);\r\n} else\r\n    throw new GeneralException(String.format(\"شما در سلسله مراتب پرسنل %s قرار ندارید.\", encouragedPerson.getPersonnelOrganizationID()));"
  ],
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode()))": [
    "EncouragementReview encouragementReview \u003d list.get(0);",
    "encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());",
    "encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());"
  ],
  "addOrUpdateEncouragement / if (list.isEmpty())": [
    "this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);"
  ],
  "addOrUpdateEncouragement / if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()))": [
    "encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());"
  ],
  "addOrUpdateEncouragement / if (!encouragement.getIsEncouragementSeen())": [
    "List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());",
    "if (list.isEmpty()) {\r\n    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n} else {\r\n    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n        EncouragementReview encouragementReview \u003d list.get(0);\r\n        encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n        encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n    }\r\n}",
    "if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n    encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n}",
    "encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);"
  ],
  "addOrUpdateEncouragement / if (request.getEncouragementDraft() !\u003d null \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode()))": [
    "if (!encouragement.getIsEncouragementSeen()) {\r\n    List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n    if (list.isEmpty()) {\r\n        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n    } else {\r\n        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n        if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n            EncouragementReview encouragementReview \u003d list.get(0);\r\n            encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n            encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n        }\r\n    }\r\n    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n        encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n    }\r\n    encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);\r\n} else\r\n    throw new GeneralException(\"این تشویق مشاهده شده و قابل ویرایش نیست\");"
  ],
  "addOrUpdateEncouragement / if (!resultList.isEmpty() \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode()))": [
    "resultList.forEach(encouragement -\u003e {\r\n    try {\r\n        if (request.getEncouragementDraft() !\u003d null \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) {\r\n            if (!encouragement.getIsEncouragementSeen()) {\r\n                List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                if (list.isEmpty()) {\r\n                    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                } else {\r\n                    this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n                        EncouragementReview encouragementReview \u003d list.get(0);\r\n                        encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n                        encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n                    }\r\n                }\r\n                if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n                    encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n                }\r\n                encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);\r\n            } else\r\n                throw new GeneralException(\"این تشویق مشاهده شده و قابل ویرایش نیست\");\r\n        }\r\n    } catch (Exception e) {\r\n        throw new RuntimeException(e);\r\n    }\r\n});"
  ],
  "addOrUpdateEncouragement / if (request !\u003d null \u0026\u0026 request.getEncouragementRelatedPersonnelOrganizationIds() !\u003d null)": [
    "List\u003cEncouragement\u003e encouragements \u003d new ArrayList\u003c\u003e();",
    "EncouragementReasonType reasonType \u003d null;",
    "if (request.getReasonId() !\u003d null \u0026\u0026 request.getType() !\u003d null \u0026\u0026 request.getType().getTypeId() !\u003d null)\r\n    reasonType \u003d this.findReasonType(request.getReasonId(), request.getType().getTypeId());",
    "validate(request.getAmount(), reasonType);",
    "for (String personnelOrganizationId : request.getEncouragementRelatedPersonnelOrganizationIds()) {\r\n    PersonnelDTO encouragedPerson \u003d (PersonnelDTO) personnelService.findByOrganizationId(personnelOrganizationId, typeOfPersonnelDTOWithManagerSending);\r\n    if (!encouragedPerson.getPersonnelMembershipCode().equals(MembershipType.PERMANENT.getCode()))\r\n        throw new ValidationException(\"شخص انتخاب شده، رسمی نمی باشد.\");\r\n    /**\r\n     * @CheckBothAreExistsInSameOrganization\r\n     */\r\n    if ((registrar.getPersonnelUnitCode() \u003d\u003d null || encouragedPerson.getPersonnelUnitCode() \u003d\u003d null) || Objects.equals(registrar.getPersonnelUnitCode(), encouragedPerson.getPersonnelUnitCode())) {\r\n        /**\r\n         * @CheckExistsRegistrarInPersonnelManager\r\n         */\r\n        if (encouragedPerson.getPersonnelManager() !\u003d null \u0026\u0026 encouragedPerson.getPersonnelManager().getPersonnelManagerOrganizationIdList().stream().anyMatch(managerOrganizationId -\u003e managerOrganizationId.equals(registrar.getPersonnelOrganizationID()))) {\r\n            Encouragement encouragement \u003d createOrUpdateEncouragement(request, reasonType, registrar.getPersonnelOrganizationID(), personnelOrganizationId);\r\n            encouragement.setEncouragementTypeCategory(TypeCategoryEnum.NORMAL);\r\n            if (encouragement.getEncouragementStatus() !\u003d null \u0026\u0026 !encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n                if (!DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n                    encouragement.setEncouragementStatus(EncouragementResultEnum.DRAFT.getCode());\r\n                else {\r\n                    if (encouragement.getEncouragementStatus() \u003d\u003d null || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.DRAFT.getCode()))\r\n                        encouragement.setEncouragementStatus(EncouragementResultEnum.UNDER_REVIEW.getCode());\r\n                    if (DraftEnum.fromCode(request.getEncouragementDraft()).equals(DraftEnum.Sent))\r\n                        encouragement.setEncouragementSentDraftDate(LocalDate.now());\r\n                }\r\n            }\r\n            encouragements.add(encouragement);\r\n        } else\r\n            throw new GeneralException(String.format(\"شما در سلسله مراتب پرسنل %s قرار ندارید.\", encouragedPerson.getPersonnelOrganizationID()));\r\n    } else\r\n        throw new GeneralException(String.format(\"تشویق شونده ی %s در یگان شما نمی باشد.\", encouragedPerson.getPersonnelOrganizationID()));\r\n}",
    "List\u003cEncouragement\u003e resultList \u003d encouragementRepository.saveAll(encouragements);",
    "if (!resultList.isEmpty() \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) {\r\n    resultList.forEach(encouragement -\u003e {\r\n        try {\r\n            if (request.getEncouragementDraft() !\u003d null \u0026\u0026 request.getEncouragementDraft().equals(DraftEnum.Sent.getCode())) {\r\n                if (!encouragement.getIsEncouragementSeen()) {\r\n                    List\u003cEncouragementReview\u003e list \u003d encouragementReviewService.getReviewOfThisRegistrarThisEncouragementWithReviewerType(encouragement.getEncouragementRegistrarOrganizationId(), encouragement.getEncouragementId(), ReviewTypeEnum.ORDINARY_REVIEWER.getCode());\r\n                    if (list.isEmpty()) {\r\n                        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.FALSE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                    } else {\r\n                        this.calculator(encouragement, request.getType().getTypeId(), registrar, Boolean.TRUE, request.getEncouragementDraft(), true, false, true, encouragement.getEncouragementRegistrarOrganizationId(), currentUserRole);\r\n                        if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode()) || encouragement.getEncouragementStatus().equals(EncouragementResultEnum.NEED_FOR_ACCEPT.getCode())) {\r\n                            EncouragementReview encouragementReview \u003d list.get(0);\r\n                            encouragementReview.setEncouragementReviewSentDraftDate(LocalDate.now());\r\n                            encouragementReviewService.changeEncouragementReviewStatus(encouragementReview, ReviewResultEnum.APPROVED.getCode());\r\n                        }\r\n                    }\r\n                    if (encouragement.getEncouragementStatus().equals(ReviewResultEnum.SENT_FOR_REGISTRAR_CORRECTION.getCode())) {\r\n                        encouragement.setEncouragementStatus(ReviewResultEnum.UNDER_REVIEW.getCode());\r\n                    }\r\n                    encouragementReviewService.updateSentForRegistrarEncouragementReviewHasBeenSeen(encouragement);\r\n                } else\r\n                    throw new GeneralException(\"این تشویق مشاهده شده و قابل ویرایش نیست\");\r\n            }\r\n        } catch (Exception e) {\r\n            throw new RuntimeException(e);\r\n        }\r\n    });\r\n}",
    "return resultList;"
  ],
  "addOrUpdateEncouragementByEncouragementSpecialist / if (dto.getReasonId() !\u003d null \u0026\u0026 dto.getType() !\u003d null \u0026\u0026 dto.getType().getTypeId() !\u003d null)": [
    "reasonType \u003d this.findReasonType(dto.getReasonId(), dto.getType().getTypeId());"
  ],
  "addOrUpdateEncouragementByEncouragementSpecialist / if (dto.getEncouragementDraft().equals(DraftEnum.Sent.getCode()))": [
    "this.calculator(encouragement, finalReasonType.getEncouragementTypeId(), registrar, Boolean.FALSE, dto.getEncouragementDraft(), false, false, true, null, currentUserRole);"
  ],
  "addOrUpdateEncouragementByEncouragementSpecialist / if (encouragement.getEncouragementId() !\u003d null)": [
    "FileAttachmentDTO fileAttachmentDTO \u003d FileAttachmentDTO.builder().encouragementId(encouragement.getEncouragementId()).build();",
    "try {\r\n    addFile(fileList, finalDeleteFileIdList, fileAttachmentDTO);\r\n    if (dto.getEncouragementDraft().equals(DraftEnum.Sent.getCode()))\r\n        this.calculator(encouragement, finalReasonType.getEncouragementTypeId(), registrar, Boolean.FALSE, dto.getEncouragementDraft(), false, false, true, null, currentUserRole);\r\n} catch (Exception e) {\r\n    throw new RuntimeException(e);\r\n}"
  ],
  "changeEncouragementStatus / if (status !\u003d null \u0026\u0026 (status.equals(EncouragementResultEnum.APPROVED.getCode()) || status.equals(EncouragementResultEnum.REJECTED.getCode()) || status.equals(EncouragementResultEnum.CORRECTION_AND_APPROVAL.getCode())))": [
    "encouragement.setEncouragementAppliedDate(LocalDate.now());"
  ],
  "changeEncouragementStatus / if (status !\u003d null \u0026\u0026 (status.equals(EncouragementResultEnum.SENT_FOR_CORRECTION.getCode())))": [
    "encouragement.setIsEncouragementSeen(Boolean.FALSE);"
  ],
  "changeEncouragementStatus / if (encouragement !\u003d null)": [
    "encouragement.setEncouragementStatus(status);",
    "if (status !\u003d null \u0026\u0026 (status.equals(EncouragementResultEnum.APPROVED.getCode()) || status.equals(EncouragementResultEnum.REJECTED.getCode()) || status.equals(EncouragementResultEnum.CORRECTION_AND_APPROVAL.getCode()))) {\r\n    encouragement.setEncouragementAppliedDate(LocalDate.now());\r\n}",
    "if (status !\u003d null \u0026\u0026 (status.equals(EncouragementResultEnum.SENT_FOR_CORRECTION.getCode())))\r\n    encouragement.setIsEncouragementSeen(Boolean.FALSE);",
    "encouragementRepository.save(encouragement);"
  ]
}